{"mappings":"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","sources":["<anon>","src/js/wiimd.js"],"sourcesContent":["var $4811da1c274ad200$exports = {};\nwindow.WIIM = window.WIIM || {};\nWIIM.s = {\n    locHostname: location.hostname,\n    locPort: location.port && location.port != \"80\" && location.port != \"1234\" ? location.port : \"80\",\n    rndAlbumArtUri: \"./img/album-unknown.jpg\",\n    aDeviceUI: [\n        \"devName\",\n        \"mediaTitle\",\n        \"mediaSubTitle\",\n        \"mediaArtist\",\n        \"mediaAlbum\",\n        \"mediaBitRate\",\n        \"mediaBitDepth\",\n        \"mediaSampleRate\",\n        \"mediaQualityIdent\",\n        \"devVol\",\n        \"progressPlayed\",\n        \"progressLeft\",\n        \"progressPercent\",\n        \"mediaSource\",\n        \"albumArt\",\n        \"bgAlbumArtBlur\"\n    ]\n};\nWIIM.d = {\n    serverSettings: null,\n    deviceList: null,\n    prevTransportState: null,\n    prevPlayMedium: null,\n    prevSourceIdent: null,\n    prevTrackInfo: null\n};\nWIIM.r = {};\nWIIM.Init = function() {\n    console.log(\"WIIM\", \"Initialising...\");\n    window.socket = parent.socket;\n    console.log(\"WIIM\", \"Socket\", window.socket);\n    this.setUIReferences();\n    this.setSocketDefinitions();\n    setTimeout(()=>{\n        console.log(\"WIIM\", \"Update request sent\");\n        socket.emit(\"update-request\");\n    }, 500);\n};\nWIIM.updateTrackProgress = function(state) {\n    var playerProgress = WIIM.getPlayerProgress(state.trackPos / 1000, state.trackLen / 1000, state.state);\n    WIIM.r.progressPlayed.children[0].innerText = playerProgress.played;\n    WIIM.r.progressLeft.children[0].innerText = playerProgress.left != \"\" ? \"-\" + playerProgress.left : \"\";\n    WIIM.r.progressPercent.setAttribute(\"aria-valuenow\", playerProgress.percent);\n    WIIM.r.progressPercent.children[0].setAttribute(\"style\", \"width:\" + playerProgress.percent + \"%\");\n};\nWIIM.updateTrack = function(state) {\n    console.log(state);\n    if (state.state == \"stopped\") {\n        WIIM.r.mediaTitle.innerText = \"\";\n        WIIM.r.mediaSubTitle.innerText = \"\";\n        WIIM.r.mediaArtist.innerText = \"\";\n        WIIM.r.mediaBitRate.innerText = \"\";\n        WIIM.r.mediaBitDepth.innerText = \"\";\n        WIIM.r.mediaSampleRate.innerText = \"\";\n    } else {\n        WIIM.r.mediaTitle.innerText = state.trackTitle;\n        WIIM.r.mediaSubTitle.innerText = state.trackSubTitle;\n        WIIM.r.mediaArtist.innerText = state.artist;\n        WIIM.r.mediaBitRate.innerText = state.bitRate > 0 ? state.bitRate > 1000 ? (state.bitRate / 1000).toFixed(2) + \" mbps, \" : state.bitRate + \" kbps, \" : \"\";\n        WIIM.r.mediaBitDepth.innerText = state.bitDepth > 0 ? state.bitDepth > 24 ? \"24 bit /\" : state.bitDepth + \" bit /\" : \"\";\n        WIIM.r.mediaSampleRate.innerText = state.sampleRate > 0 ? (state.sampleRate / 1000).toFixed(1) + \" kHz\" : \"\";\n    }\n    if (state.source == \"network\" && state.state != \"stopped\") {\n        WIIM.r.mediaQualityIdent.style.display = \"inline-block\";\n        WIIM.r.mediaQualityIdent.className = \"badge badge-outlined\";\n    } else WIIM.r.mediaQualityIdent.style.display = \"none\";\n};\nWIIM.updateAlbumArt = function(state) {\n    WIIM.r.mediaAlbum.innerText = \"\";\n    if (state.source == \"network\") {\n        if (state.state == \"stopped\") WIIM.setAlbumArt(\"./img/album-silence.jpg\");\n        else {\n            if (state.albumArt) {\n                var albumArtUri = WIIM.checkAlbumArtURI(state, Date.now());\n                WIIM.setAlbumArt(albumArtUri);\n            } else WIIM.setAlbumArt(\"./img/album-unknown.jpg\");\n            WIIM.r.mediaAlbum.innerText = state.album;\n        }\n    } else if (state.source == \"bt\") {\n        if (state.state == \"stopped\") WIIM.setAlbumArt(\"./img/album-silence.jpg\");\n        else WIIM.setAlbumArt(\"./img/album-bt.jpg\");\n    } else if (state.source == \"optin\") WIIM.setAlbumArt(\"./img/album-spdif.jpg\");\n    else if (state.source == \"linein\") WIIM.setAlbumArt(\"./img/album-linein.jpg\");\n};\nWIIM.updateSourceImg = function(state) {\n    var identImg = document.createElement(\"img\");\n    if (state.source == \"network\") identImg.src = \"./img/sources/ethernet2.png\";\n    else if (state.source == \"bt\") identImg.src = \"./img/sources/bluetooth2.png\";\n    else if (state.source == \"linein\") identImg.src = \"./img/sources/line-in2.png\";\n    else if (state.source == \"optin\") identImg.src = \"./img/sources/spdif2.png\";\n    if (state.vendor == \"tidal\") identImg.src = \"./img/sources/tidal2.png\";\n    if (state.vendor == \"spotify\") identImg.src = \"./img/sources/spotify.png\";\n    WIIM.r.mediaSource.innerHTML = identImg.outerHTML;\n};\nWIIM.setUIReferences = function() {\n    console.log(\"WIIM\", \"Set UI references...\");\n    function addElementToRef(id) {\n        const element = document.getElementById(id);\n        if (element) WIIM.r[id] = element;\n        else console.warn(\"WIIM\", `Element with ID '${id}' not found.`);\n    }\n    this.s.aDeviceUI.forEach((id)=>{\n        addElementToRef(id);\n    });\n};\nWIIM.setSocketDefinitions = function() {\n    console.log(\"WIIM\", \"Setting Socket definitions...\");\n    socket.on(\"device-state\", function(state) {\n        WIIM.r.devVol.innerText = state.volume;\n        WIIM.r.devName.innerText = state.name + ' / ' + state.model;\n        if (state.mute === '1') WIIM.r.devVol.innerText = \"mute\";\n    });\n    socket.on(\"stream-state\", function(state) {\n        WIIM.updateTrack(state);\n        WIIM.updateTrackProgress(state);\n        WIIM.updateSourceImg(state);\n        WIIM.updateAlbumArt(state);\n    });\n    socket.on(\"album-changed\", function(state) {\n        WIIM.updateAlbumArt(state);\n    });\n    socket.on(\"track-progress\", function(state) {\n        WIIM.updateTrackProgress(state);\n    });\n    socket.on(\"track-changed\", function(state) {\n        WIIM.updateTrack(state);\n    });\n};\nWIIM.getPlayerProgress = function(trackPos, trackDuration, currentTransportState) {\n    if (currentTransportState == \"stopped\") return {\n        played: \"Stopped (No music selected)\",\n        left: \"\",\n        total: \"\",\n        percent: 0\n    };\n    else if (trackDuration > 0 && trackPos < trackDuration) {\n        var percentPlayed = (trackPos / trackDuration * 100).toFixed(1);\n        var playedValue = WIIM.convertToMinutes(trackPos);\n        if (currentTransportState == \"paused\") playedValue = \"Paused \" + playedValue;\n        return {\n            played: playedValue,\n            left: WIIM.convertToMinutes(trackDuration - trackPos),\n            total: WIIM.convertToMinutes(trackDuration),\n            percent: percentPlayed\n        };\n    } else if (trackDuration == 0 && currentTransportState == \"playing\") return {\n        played: \"Live Stream\",\n        left: \"\",\n        total: \"\",\n        percent: 100\n    };\n    else return {\n        played: \"\",\n        left: \"\",\n        total: \"\",\n        percent: 100\n    };\n};\nWIIM.convertToSeconds = function(sDuration) {\n    if (sDuration === undefined || sDuration === \"0\") return 0;\n    const timeSections = sDuration.split(\":\");\n    let totalSeconds = 0;\n    for(let i = 0; i < timeSections.length; i++){\n        var nFactor = timeSections.length - 1 - i;\n        var nMultiplier = Math.pow(60, nFactor);\n        totalSeconds += nMultiplier * parseInt(timeSections[i]);\n    }\n    return totalSeconds;\n};\nWIIM.convertToMinutes = function(seconds) {\n    var tempDate = new Date(0);\n    tempDate.setSeconds(seconds);\n    var result = tempDate.toISOString().substring(14, 19);\n    return result;\n};\nWIIM.checkAlbumArtURI = function(state, nTimestamp) {\n    var sAlbumArtUri = state.albumArt;\n    if (sAlbumArtUri && sAlbumArtUri.startsWith(\"https\")) {\n        if (WIIM.s.locPort != \"80\") return \"http://\" + WIIM.s.locHostname + \":\" + WIIM.s.locPort + \"/proxy?url=\" + encodeURIComponent(sAlbumArtUri) + \"&ts=\" + nTimestamp;\n        else return \"http://\" + WIIM.s.locHostname + \"/proxy?url=\" + encodeURIComponent(sAlbumArtUri) + \"&ts=\" + nTimestamp;\n    } else if (sAlbumArtUri && sAlbumArtUri.startsWith(\"http\")) {\n        if (state.vendor == 'tunein') {\n            sAlbumArtUri = sAlbumArtUri.replace('http:', 'https:');\n            console.log(\"URI \", sAlbumArtUri);\n            return \"http://\" + WIIM.s.locHostname + \":\" + WIIM.s.locPort + \"/proxy?url=\" + encodeURIComponent(sAlbumArtUri) + \"&ts=\" + nTimestamp;\n        }\n        return sAlbumArtUri;\n    }\n    return \"\";\n};\nWIIM.setAlbumArt = function(imgUri) {\n    console.log(\"WIIM\", \"Set Album Art\", imgUri);\n    this.r.albumArt.src = imgUri;\n    this.r.bgAlbumArtBlur.style.backgroundImage = \"url('\" + imgUri + \"')\";\n};\nWIIM.getSourceIdent = function(playMedium, trackSource) {\n    var sIdentUri = \"\";\n    switch(playMedium.toLowerCase()){\n        case \"airplay\":\n            sIdentUri = \"./img/sources/airplay2.png\";\n            break;\n        case \"third-dlna\":\n            sIdentUri = \"./img/sources/dlna2.png\";\n            break;\n        case \"cast\":\n            sIdentUri = \"./img/sources/chromecast2.png\";\n            break;\n        case \"radio-network\":\n            sIdentUri = \"./img/sources/radio.png\";\n            break;\n        case \"songlist-network\":\n            sIdentUri = \"./img/sources/ethernet2.png\";\n            break;\n        case \"spotify\":\n            sIdentUri = \"./img/sources/spotify.png\";\n            break;\n        case \"squeezelite\":\n            sIdentUri = \"./img/sources/music-assistant2.png\";\n            break;\n        case \"none\":\n            sIdentUri = \"./img/sources/none2.png\";\n            break;\n        case \"bluetooth\":\n            sIdentUri = \"./img/sources/bluetooth2.png\";\n            break;\n        case \"hdmi\":\n            sIdentUri = \"./img/sources/hdmi2.png\";\n            break;\n        case \"line-in\":\n            sIdentUri = \"./img/sources/line-in2.png\";\n            break;\n        case \"optical\":\n            sIdentUri = \"./img/sources/spdif2.png\";\n            break;\n    }\n    switch(trackSource.toLowerCase()){\n        case \"deezer\":\n        case \"deezer2\":\n            sIdentUri = \"./img/sources/deezer.png\";\n            break;\n        case \"iheartradio\":\n            sIdentUri = \"./img/sources/iheart.png\";\n            break;\n        case \"newtunein\":\n            sIdentUri = \"./img/sources/newtunein.png\";\n            break;\n        case \"plex\":\n            sIdentUri = \"./img/sources/plex.png\";\n            break;\n        case \"prime\":\n            sIdentUri = \"./img/sources/amazon-music2.png\";\n            break;\n        case \"qobuz\":\n            sIdentUri = \"./img/sources/qobuz2.png\";\n            break;\n        case \"tidal\":\n            sIdentUri = \"./img/sources/tidal2.png\";\n            break;\n        case \"upnpserver\":\n            sIdentUri = \"./img/sources/dlna2.png\";\n            break;\n        case \"vtuner\":\n            sIdentUri = \"./img/sources/vtuner2.png\";\n            break;\n    }\n    return sIdentUri;\n};\nWIIM.Init();\n\n\n//# sourceMappingURL=wiimd.4794ebd1.js.map\n","window.WIIM = window.WIIM || {};\n\nWIIM.s = {\n    locHostname: location.hostname,\n    locPort: (location.port && location.port != \"80\" && location.port != \"1234\") ? location.port : \"80\",\n    rndAlbumArtUri: \"./img/album-unknown.jpg\",\n    aDeviceUI: [\"devName\", \"mediaTitle\", \"mediaSubTitle\", \"mediaArtist\", \"mediaAlbum\", \"mediaBitRate\",\n        \"mediaBitDepth\", \"mediaSampleRate\", \"mediaQualityIdent\", \"devVol\", \"progressPlayed\",\n        \"progressLeft\", \"progressPercent\", \"mediaSource\", \"albumArt\", \"bgAlbumArtBlur\"],\n};\n\nWIIM.d = {\n    serverSettings: null,\n    deviceList: null,\n    prevTransportState: null,\n    prevPlayMedium: null,\n    prevSourceIdent: null,\n    prevTrackInfo: null,\n};\n\nWIIM.r = {};\n\nWIIM.Init = function () {\n    console.log(\"WIIM\", \"Initialising...\");\n    window.socket = parent.socket;\n    console.log(\"WIIM\", \"Socket\", window.socket);\n    this.setUIReferences();\n    this.setSocketDefinitions();\n    setTimeout(() => {\n        console.log(\"WIIM\", \"Update request sent\");\n        socket.emit(\"update-request\");\n    }, 500);\n};\n\nWIIM.updateTrackProgress = function (state) {\n    var playerProgress = WIIM.getPlayerProgress(state.trackPos / 1000, state.trackLen / 1000, state.state);\n    WIIM.r.progressPlayed.children[0].innerText = playerProgress.played;\n    WIIM.r.progressLeft.children[0].innerText = (playerProgress.left != \"\") ? \"-\" + playerProgress.left : \"\";\n    WIIM.r.progressPercent.setAttribute(\"aria-valuenow\", playerProgress.percent)\n    WIIM.r.progressPercent.children[0].setAttribute(\"style\", \"width:\" + playerProgress.percent + \"%\");\n};\n\nWIIM.updateTrack = function (state) {\n    console.log(state);\n    if (state.state == \"stopped\") {\n        WIIM.r.mediaTitle.innerText = \"\";\n        WIIM.r.mediaSubTitle.innerText = \"\";\n        WIIM.r.mediaArtist.innerText = \"\";\n        WIIM.r.mediaBitRate.innerText = \"\";\n        WIIM.r.mediaBitDepth.innerText = \"\";\n        WIIM.r.mediaSampleRate.innerText = \"\";\n    }\n    else {\n        WIIM.r.mediaTitle.innerText = state.trackTitle;\n        WIIM.r.mediaSubTitle.innerText = state.trackSubTitle;\n        WIIM.r.mediaArtist.innerText = state.artist;\n        WIIM.r.mediaBitRate.innerText = (state.bitRate > 0) ?\n            ((state.bitRate > 1000) ? (state.bitRate / 1000).toFixed(2) + \" mbps, \" : state.bitRate + \" kbps, \") : \"\";\n        WIIM.r.mediaBitDepth.innerText = (state.bitDepth > 0) ?\n            ((state.bitDepth > 24) ? \"24 bit /\" : state.bitDepth + \" bit /\") : \"\";\n        WIIM.r.mediaSampleRate.innerText = (state.sampleRate > 0) ? (state.sampleRate / 1000).toFixed(1) + \" kHz\" : \"\";\n    }\n    if (state.source == \"network\" && state.state != \"stopped\") {\n        WIIM.r.mediaQualityIdent.style.display = \"inline-block\";\n        WIIM.r.mediaQualityIdent.className = \"badge badge-outlined\";\n    }\n    else {\n        WIIM.r.mediaQualityIdent.style.display = \"none\";\n    }\n}\n\nWIIM.updateAlbumArt = function (state) {\n    WIIM.r.mediaAlbum.innerText = \"\";\n    if (state.source == \"network\") {\n        if (state.state == \"stopped\") {\n            WIIM.setAlbumArt(\"./img/album-silence.jpg\");\n        }\n        else {\n            if (state.albumArt) {\n                var albumArtUri = WIIM.checkAlbumArtURI(state, Date.now());\n                WIIM.setAlbumArt(albumArtUri);\n            }\n            else {\n                WIIM.setAlbumArt(\"./img/album-unknown.jpg\");\n            }\n            WIIM.r.mediaAlbum.innerText = state.album;\n        }\n    }\n    else if (state.source == \"bt\") {\n        if (state.state == \"stopped\") {\n            WIIM.setAlbumArt(\"./img/album-silence.jpg\");\n        }\n        else {\n            WIIM.setAlbumArt(\"./img/album-bt.jpg\");\n        }\n    }\n    else if (state.source == \"optin\") {\n        WIIM.setAlbumArt(\"./img/album-spdif.jpg\");\n    }\n    else if (state.source == \"linein\") {\n        WIIM.setAlbumArt(\"./img/album-linein.jpg\");\n    }\n}\n\nWIIM.updateSourceImg = function (state) {\n    var identImg = document.createElement(\"img\");\n    if (state.source == \"network\")\n        identImg.src = \"./img/sources/ethernet2.png\";\n    else if (state.source == \"bt\")\n        identImg.src = \"./img/sources/bluetooth2.png\";\n    else if (state.source == \"linein\")\n        identImg.src = \"./img/sources/line-in2.png\";\n    else if (state.source == \"optin\")\n        identImg.src = \"./img/sources/spdif2.png\";\n    if (state.vendor == \"tidal\")\n        identImg.src = \"./img/sources/tidal2.png\";\n    if (state.vendor == \"spotify\")\n        identImg.src = \"./img/sources/spotify.png\";\n    WIIM.r.mediaSource.innerHTML = identImg.outerHTML;\n}\n\nWIIM.setUIReferences = function () {\n    console.log(\"WIIM\", \"Set UI references...\");\n    function addElementToRef(id) {\n        const element = document.getElementById(id);\n        if (element) {\n            WIIM.r[id] = element;\n        } else {\n            console.warn(\"WIIM\", `Element with ID '${id}' not found.`);\n        }\n    }\n    this.s.aDeviceUI.forEach((id) => { addElementToRef(id); });\n};\n\nWIIM.setSocketDefinitions = function () {\n    console.log(\"WIIM\", \"Setting Socket definitions...\")\n    \n    socket.on(\"device-state\", function (state) {\n        WIIM.r.devVol.innerText = state.volume;\n        WIIM.r.devName.innerText = state.name + ' / ' + state.model;\n        if (state.mute === '1')\n            WIIM.r.devVol.innerText = \"mute\";\n    });\n\n    socket.on(\"stream-state\", function (state) {\n        WIIM.updateTrack(state);\n        WIIM.updateTrackProgress(state);\n        WIIM.updateSourceImg(state);\n        WIIM.updateAlbumArt(state);\n    });\n\n    socket.on(\"album-changed\", function (state) {\n        WIIM.updateAlbumArt(state);\n    });\n\n    socket.on(\"track-progress\", function (state) {\n        WIIM.updateTrackProgress(state);\n    });\n\n    socket.on(\"track-changed\", function (state) {\n        WIIM.updateTrack(state);\n    });\n};\n\nWIIM.getPlayerProgress = function (trackPos, trackDuration, currentTransportState) {\n    if (currentTransportState == \"stopped\") {\n        return {\n            played: \"Stopped (No music selected)\",\n            left: \"\",\n            total: \"\",\n            percent: 0\n        };\n    }\n    else if (trackDuration > 0 && trackPos < trackDuration) {\n        var percentPlayed = ((trackPos / trackDuration) * 100).toFixed(1);\n        var playedValue = WIIM.convertToMinutes(trackPos);\n        if (currentTransportState == \"paused\")\n            playedValue = \"Paused \" + playedValue;\n        return {\n            played: playedValue,\n            left: WIIM.convertToMinutes(trackDuration - trackPos),\n            total: WIIM.convertToMinutes(trackDuration),\n            percent: percentPlayed\n        };\n    }\n    else if (trackDuration == 0 && currentTransportState == \"playing\") {\n        return {\n            played: \"Live Stream\",\n            left: \"\",\n            total: \"\",\n            percent: 100\n        };\n    }\n    else {\n        return {\n            played: \"\",\n            left: \"\",\n            total: \"\",\n            percent: 100\n        };\n    }\n};\n\nWIIM.convertToSeconds = function (sDuration) {\n    if (sDuration === undefined || sDuration === \"0\")\n        return 0;\n    const timeSections = sDuration.split(\":\");\n    let totalSeconds = 0;\n    for (let i = 0; i < timeSections.length; i++) {\n        var nFactor = timeSections.length - 1 - i;\n        var nMultiplier = Math.pow(60, nFactor);\n        totalSeconds += nMultiplier * parseInt(timeSections[i]);\n    }\n    return totalSeconds\n};\n\nWIIM.convertToMinutes = function (seconds) {\n    var tempDate = new Date(0);\n    tempDate.setSeconds(seconds);\n    var result = tempDate.toISOString().substring(14, 19);\n    return result;\n};\n\nWIIM.checkAlbumArtURI = function (state, nTimestamp) {\n    var sAlbumArtUri = state.albumArt;\n    if (sAlbumArtUri && sAlbumArtUri.startsWith(\"https\")) {\n        if (WIIM.s.locPort != \"80\") {\n            return \"http://\" + WIIM.s.locHostname + \":\" + WIIM.s.locPort + \"/proxy?url=\" + encodeURIComponent(sAlbumArtUri) + \"&ts=\" + nTimestamp;\n        } else {\n            return \"http://\" + WIIM.s.locHostname + \"/proxy?url=\" + encodeURIComponent(sAlbumArtUri) + \"&ts=\" + nTimestamp;\n        }\n    } else if (sAlbumArtUri && sAlbumArtUri.startsWith(\"http\")) {\n        if (state.vendor == 'tunein') {\n            sAlbumArtUri = sAlbumArtUri.replace('http:', 'https:');\n            console.log(\"URI \", sAlbumArtUri);\n            return \"http://\" + WIIM.s.locHostname + \":\" + WIIM.s.locPort + \"/proxy?url=\" + encodeURIComponent(sAlbumArtUri) + \"&ts=\" + nTimestamp;\n        }\n        return sAlbumArtUri;\n    }\n    return \"\";\n};\n\nWIIM.setAlbumArt = function (imgUri) {\n    console.log(\"WIIM\", \"Set Album Art\", imgUri);\n    this.r.albumArt.src = imgUri;\n    this.r.bgAlbumArtBlur.style.backgroundImage = \"url('\" + imgUri + \"')\";\n};\n\nWIIM.getSourceIdent = function (playMedium, trackSource) {\n    var sIdentUri = \"\";\n    switch (playMedium.toLowerCase()) {\n        case \"airplay\":\n            sIdentUri = \"./img/sources/airplay2.png\";\n            break;\n        case \"third-dlna\":\n            sIdentUri = \"./img/sources/dlna2.png\";\n            break;\n        case \"cast\":\n            sIdentUri = \"./img/sources/chromecast2.png\";\n            break;\n        case \"radio-network\":\n            sIdentUri = \"./img/sources/radio.png\";\n            break;\n        case \"songlist-network\":\n            sIdentUri = \"./img/sources/ethernet2.png\";\n            break;\n        case \"spotify\":\n            sIdentUri = \"./img/sources/spotify.png\";\n            break;\n        case \"squeezelite\":\n            sIdentUri = \"./img/sources/music-assistant2.png\";\n            break;\n        case \"none\":\n            sIdentUri = \"./img/sources/none2.png\";\n            break;\n        case \"bluetooth\":\n            sIdentUri = \"./img/sources/bluetooth2.png\";\n            break;\n        case \"hdmi\":\n            sIdentUri = \"./img/sources/hdmi2.png\";\n            break;\n        case \"line-in\":\n            sIdentUri = \"./img/sources/line-in2.png\";\n            break;\n        case \"optical\":\n            sIdentUri = \"./img/sources/spdif2.png\";\n            break;\n    };\n    switch (trackSource.toLowerCase()) {\n        case \"deezer\":\n        case \"deezer2\":\n            sIdentUri = \"./img/sources/deezer.png\";\n            break;\n        case \"iheartradio\":\n            sIdentUri = \"./img/sources/iheart.png\";\n            break;\n        case \"newtunein\":\n            sIdentUri = \"./img/sources/newtunein.png\";\n            break;\n        case \"plex\":\n            sIdentUri = \"./img/sources/plex.png\";\n            break;\n        case \"prime\":\n            sIdentUri = \"./img/sources/amazon-music2.png\";\n            break;\n        case \"qobuz\":\n            sIdentUri = \"./img/sources/qobuz2.png\";\n            break;\n        case \"tidal\":\n            sIdentUri = \"./img/sources/tidal2.png\";\n            break;\n        case \"upnpserver\":\n            sIdentUri = \"./img/sources/dlna2.png\";\n            break;\n        case \"vtuner\":\n            sIdentUri = \"./img/sources/vtuner2.png\";\n            break;\n    };\n    return sIdentUri;\n};\n\nWIIM.Init();\n"],"names":["window","WIIM","s","locHostname","location","hostname","locPort","port","rndAlbumArtUri","aDeviceUI","d","serverSettings","deviceList","prevTransportState","prevPlayMedium","prevSourceIdent","prevTrackInfo","r","Init","console","log","socket","parent","setUIReferences","setSocketDefinitions","setTimeout","emit","updateTrackProgress","state","playerProgress","getPlayerProgress","trackPos","trackLen","progressPlayed","children","innerText","played","progressLeft","left","progressPercent","setAttribute","percent","updateTrack","mediaTitle","mediaSubTitle","mediaArtist","mediaBitRate","mediaBitDepth","mediaSampleRate","trackTitle","trackSubTitle","artist","bitRate","toFixed","bitDepth","sampleRate","source","mediaQualityIdent","style","display","className","updateAlbumArt","mediaAlbum","setAlbumArt","albumArt","albumArtUri","checkAlbumArtURI","Date","now","album","updateSourceImg","identImg","document","createElement","src","vendor","mediaSource","innerHTML","outerHTML","forEach","id","element","getElementById","warn","on","devVol","volume","devName","name","model","mute","trackDuration","currentTransportState","total","percentPlayed","playedValue","convertToMinutes","convertToSeconds","sDuration","undefined","timeSections","split","totalSeconds","i","length","nMultiplier","Math","pow","parseInt","seconds","tempDate","setSeconds","toISOString","substring","nTimestamp","sAlbumArtUri","startsWith","encodeURIComponent","replace","imgUri","bgAlbumArtBlur","backgroundImage","getSourceIdent","playMedium","trackSource","sIdentUri","toLowerCase"],"version":3,"file":"wiimd.4794ebd1.js.map"}